<!doctype html>
<html>
  <head>
    <title>Plant Monitor</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='styles.css') }}"
    />
  </head>
  <body>
    <input type="hidden" id="cropId" value="staticCropId" />
    <nav class="nav bg-dark">
      <a class="nav-link active" href="/">General</a>
      <a class="nav-link" href="/algorithms">Algorithms</a>
    </nav>
    <div class="container text-center">
      <h1>Plant Monitor</h1>
      <img
        id="camera"
        src="{{ url_for('video_feed') }}"
        class="img-fluid"
        alt="Live Camera Feed"
      />
      <div class="chart-container">
        <canvas id="greennessChart"></canvas>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/min/moment.min.js"></script>
    <!-- <script>
      function fetchGreennessHistory() {
        axios
          .get("/greenness_history")
          .then(function (response) {
            const historyData = response.data;
            let datasets = [];
            let labels = [];
            for (const roi in historyData) {
              let data = historyData[roi].map((entry) => entry.value);
              if (!labels.length) {
                labels = historyData[roi].map((entry) =>
                  new Date(entry.timestamp).toLocaleString(),
                );
              }
              datasets.push({
                label: `${roi} Greenness`,
                backgroundColor: "rgba(0, 128, 0, 0.2)",
                borderColor: `rgba(${Math.random() * 255}, ${
                  Math.random() * 255
                }, 0, 1)`,
                data: data,
              });
            }
            updateChart(labels, datasets);
          })
          .catch(function (error) {
            console.log(error);
          });
      }

      function updateChart(labels, datasets) {
        const ctx = document.getElementById("greennessChart").getContext("2d");
        new Chart(ctx, {
          type: "line",
          data: {
            labels: labels,
            datasets: datasets,
          },
          options: {
            scales: {
              x: {
                type: "category",
                time: {
                  unit: "day",
                  tooltipFormat: "MMM D, YYYY",
                  displayFormats: {
                    day: "MMM D",
                  },
                },
              },
              y: {
                beginAtZero: true,
                suggestedMax: 1,
              },
            },
          },
        });
      } -->

      <!-- window.onload = fetchGreennessHistory; -->
    <!-- </script> -->
  </body>
</html>
